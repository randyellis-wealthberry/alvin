# Milestone v2.0: Mobile & Messaging

**Status:** SHIPPED 2026-01-22
**Phases:** 11-16
**Total Plans:** 16

## Overview

Transform ALVIN into a native-like mobile experience with reliable multi-channel notifications, polished UI, and real-time updates.

## Phases

### Phase 11: PWA Foundation

**Goal**: Progressive web app with manifest, service worker, and home screen install
**Depends on**: v1.0 complete
**Status**: Complete (2026-01-17)
**Plans**: 2 plans

Plans:
- [x] 11-01: Core PWA infrastructure (Serwist + manifest)
- [x] 11-02: PWA assets and install experience

**Details:**
- Serwist service worker with precaching and runtime caching
- Web app manifest with ALVIN branding
- Home screen install prompt
- Offline fallback for document requests
- Navigation preload enabled

### Phase 12: Push Notifications

**Goal**: Native push alerts for full activity feed (reminders, escalations, family alerts)
**Depends on**: Phase 11 (service worker required)
**Status**: Complete (2026-01-19)
**Plans**: 4 plans

Plans:
- [x] 12-01: Push notification infrastructure (web-push, VAPID, PushSubscription model)
- [x] 12-02: Push subscription API endpoints (tRPC router, service worker handlers)
- [x] 12-03: Client permission UI
- [x] 12-04: Integration with reminders and escalations

**Details:**
- Web Push with VAPID authentication
- PushSubscription model in Prisma schema
- Push router with subscribe/unsubscribe mutations
- Service worker push event handling
- Notification tags for grouping/replacing
- Push-first, email-fallback pattern

### Phase 13: Offline Caching

**Goal**: View-only offline mode with cached activity history
**Depends on**: Phase 11 (service worker)
**Status**: Complete (2026-01-21)
**Plans**: 1 plan

Plans:
- [x] 13-01: Offline caching strategy implementation

**Details:**
- Cache-first strategy for static assets
- Network-first for API calls with offline fallback
- Cached activity history for offline viewing
- Read-only mode when offline (no check-ins or chat)

### Phase 14: SMS Integration

**Goal**: Twilio SMS for user check-in reminders and family escalation alerts (L3-4)
**Depends on**: Phase 11 (can run in parallel after PWA foundation)
**Status**: Complete (2026-01-21)
**Plans**: 2 plans

Plans:
- [x] 14-01: Twilio infrastructure (schema, service, env, unified notifications)
- [x] 14-02: Family SMS + cron integration (L3/L4 alerts, reminder fallback)

**Details:**
- Phone field added to UserProfile model
- Twilio service module with graceful degradation
- SMS as third fallback in notification chain (push → email → SMS)
- L3 (courteous) and L4 (urgent) SMS templates for family contacts
- Family contact phone field support

### Phase 15: Shadcn UI Refresh

**Goal**: Replace current styling with Shadcn components for a polished, consistent look
**Depends on**: None (can run in parallel)
**Status**: Complete (2026-01-22)
**Plans**: 4 plans

Plans:
- [x] 15-01: Shadcn CSS + core components (Button, Input, Label, Card)
- [x] 15-02: Form components (Dialog, Select, Textarea, Checkbox)
- [x] 15-03: Feedback components (Alert, Badge, Skeleton, Tooltip)
- [x] 15-04: Migrate existing UI to Shadcn components

**Details:**
- Shadcn CSS variables and base styles
- Core components: Button, Input, Label, Card
- Form components: Dialog, Select, Textarea, Checkbox
- Feedback components: Alert, Badge, Skeleton, Tooltip
- Full migration of existing UI to Shadcn

### Phase 16: Convex Real-time Dashboard

**Goal**: Live updates for activity log, alerts, and status without page refresh
**Depends on**: Phase 15 recommended (UI should be stable first)
**Status**: Complete (2026-01-22)
**Plans**: 3 plans

Plans:
- [x] 16-01: Convex schema & sync utility (schema, queries, mutations, sync)
- [x] 16-02: Real-time dashboard integration (activity log subscription, write-through sync)
- [x] 16-03: Status component integration (user status subscription)

**Details:**
- Convex schema with activities and userStatus tables
- Write-through sync pattern (Prisma source of truth, Convex for real-time)
- Graceful degradation when Convex not configured
- Real-time activity log with useQuery subscriptions
- User status widget with live updates
- Connection indicator component

---

## Milestone Summary

**Key Decisions:**
- Serwist for service worker (modern, Next.js 15 compatible, replaces deprecated next-pwa)
- Service worker disabled in dev mode (Turbopack incompatible)
- Push-first, email-fallback notification pattern
- Notification tags for grouping/replacing same-type notifications
- Twilio for SMS provider (reliable, well-documented)
- SMS for both user reminders and family escalation (L3-4)
- View-only offline mode (no offline check-ins or chat)
- Write-through sync pattern for Convex (Prisma as source of truth)

**Issues Resolved:**
- PWA install experience working across browsers
- Push notification permission flow with clear UI
- Offline mode gracefully degrades features
- SMS fallback chain works correctly

**Issues Deferred:**
- In-memory WebAuthn challenges → Redis (production scalability)
- Custom escalation timing (not included in v2 scope)

**Technical Debt Incurred:**
- Webpack configured but Turbopack not (causes warning)
- Convex requires separate deployment/management

---

*For current project status, see .planning/ROADMAP.md*
